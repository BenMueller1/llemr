{% extends "pttrack/base.html" %}

{# unclear if this should be done in base.html or here... #}
{% load bootstrap3 %}

{% block title %}
Patient Details: {{ patient.last_name }}, {{ patient.first_name }} {{ patient.middle_name }}
{% endblock %}

{% block header %}
<h1>{{ patient.last_name }}, {{ patient.first_name }} {{ patient.middle_name }}</h1>
<p class="lead">{{ patient.age }} y/o {{ patient.ethnicity }} {{ patient.gender }}</p>

<p class="lead"><strong>Status:</strong> {{ patient.status }}</p>
{% endblock %}

{% block content %}

{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

<div class="container">
	<div class="row">
		<h3>Info</h3>
		<div class="container col-md-4">
			<p>Language: {{patient.language}}</p>
			<p>DOB: {{patient.date_of_birth}}</p>
		</div>
		<div class="container col-md-4">
			<p><address>
			{{ patient.address }}<br>
			{{ patient.city }}, {{ patient.state }} {{ patient.zip_code }}
			</address></p>
		</div>
		<div class="container col-md-4">
			<p>P: {{ patient.phone }}</p>
		</div>
	</div>
</div>

<div class="container">
	<h3>Notes for {{patient.first_name}} {{patient.last_name}}</h3>
	{% for note in patient.followup_set.all %}
	<div class="container">
		<p> {{ note.note }} </p>
		<p class="text-muted"> by {{ note.author.name }} at {{ note.written_date }}</p>
	</div>
	{% endfor %}
</div>

<div class="container" ng-controller="NoteFormCtrl">
	<div class="row">
		<div class="col-md-8">
			<h3>Add a New Note</h3>
		</div>
		<div class="col-md-4">
			<div class="btn-group">
		        <label class="btn btn-primary" ng-model="noteType" btn-radio="'Workup'">Workup</label>
		        <label class="btn btn-primary" ng-model="noteType" btn-radio="'Followup'">Followup</label>
			</div>
		</div>
	</div>

	<div class="form-group">
		<form action="workup/" method="post" ng-show="workup">
		    {% csrf_token %}
		    {% bootstrap_form workup_form %}
		    <input type="submit" class="btn btn-primary" value="Submit" />
		</form>
	</div>
	<div class="form-group">
		<form action="followup/" method="post" ng-hide="workup">
		    {% csrf_token %}
		    {% bootstrap_form followup_form %}
		    <input type="submit" class="btn btn-primary" value="Submit" />
		</form>
	</div>
</div>

{% endblock %}
